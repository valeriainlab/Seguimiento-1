#Activa el entorno bioinfo (que ya debería estar instalado)
conda activate bioinfo

#Crea una carpeta para almacenar y ejecutar los archivos
mkdir valeria_vega

#Te dirige a la carpeta
cd valeria_vega

#Descarga el archivo de Dasypus novemcinctus con el comando wget (url de la carpeta/nombre del archivo).
wget https://ftp.ensembl.org/pub/current_gff3/dasypus_novemcinctus/Dasypus_novemcinctus.Dasnov3.0.114.gff3.gz

#Descomprime el archivo descargado 
gunzip Dasypus_novemcinctus.Dasnov3.0.114.gff3.gz

#Toma solo la columna 3 y busca las líneas que NO empieza por "#"| lo ordena de mayor a menor-cuenta la cantidad de repeticiones de cada categoría y almacena la información en un archivo de texto
cut -f3 Dasypus_novemcinctus.Dasnov3.0.114.gff3 | grep -v "^#" | sort-uniq-count-rank  > features.txt 

#Cuenta la cantidad de features
cat features.txt | wc -l

#Numero de regiones de la secuencia (cromosoma) en el archivo
#Cuenta el número de sequence-region para saber la cantidad de secuencias únicas anotadas 
cut -f1 Dasypus_novemcinctus.Dasnov3.0.114.gff3 | grep -c "##sequence-region"
#Imprime las secuencias únicas anotadas en la columna 1
cut -f1 Dasypus_novemcinctus.Dasnov3.0.114.gff3 | grep -v "^#" | sort-uniq-count-rank | wc -l
#Imprime el número de regiones asociadas a scaffolds teniendo en cuenta que cada scaffold este asociado a un unico sequid de la columna 1 
cut -f1,3 Dasypus_novemcinctus.Dasnov3.0.114.gff3 | grep -v "^#" | grep "scaffold" | sort-uniq-count | wc -l

#Numero de genes listados en el organismo
#Muestra el conteo de genes por categoría
cut -f3 Dasypus_novemcinctus.Dasnov3.0.114.gff3 |  grep -v "^#" | grep "gene"| sort-uniq-count
#Este comando suma el total de los genes listados (gene, ncRNA_gene, pseudogene)
grep -v "^#" Dasypus_novemcinctus.Dasnov3.0.114.gff3 | cut -f3 | grep "gene" | wc -l

#Imprime en la consola el Top 10 de features más anotados en el genoma
cat features.txt | head

